---
title: "knit-engines"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{knit-engines}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
code <- function(nm) paste(knitr:::knit_code$get(nm), collapse = "\n")
library(atusydown)
```

```{.r}
library(atusydown)
```

# Additional engines for `knitr`

## `glue`

The `glue` engine is useful in programatically writing texts.
As documented in `?glue::glue`,

> Expressions enclosed by braces will be evaluated as R code. Long strings are broken by line and concatenated together. Leading whitespace and blank lines from the first and last lines are automatically trimmed.

For example, let's substitute `{name}` by "Atusy".

First use `r` engine like below.

```{r}
name <- "Atusy"
```

And then use `glue` engine like below.

````{.text}
```{`r "glue"`}
`r code("glue-brace")`
```
````

```{glue glue-brace}
**My name is {name}.**
This output is powered by glue package!
```

Nice text!
The output text is rendered as Pandoc's markdown.

Extra arguments of `glue::glue()` can be controlled by specifying `glue.args`.
A following example 
  replaces a expression enclosed by percents (`%` and `%`) 
  instead of default braces (`{` and `}`)

````{.text}
```{`r "glue"`, glue.args = list(.open = "%", .close = "%")}
`r code("glue-percent")`
```
````

```{glue glue-percent, glue.args = list(.open = "%", .close = "%")}
**My name is %name%.**
This output is powered by glue package!
```

# `options`

The `options` engine is useful for debugging.
By running a current chunk or by knitting, 
you can see chunk options of a current chunk as a structure of a list.

````{.text}
```{`r "options"`}
code("options")
```
````

```{options options}
The content of chunk is ignored.
```

If you only want to output chunk options different from `knitr::opts_chunk$get()`,
specify `options.diff = TRUE` as a chunk option.

````{.text}
```{`r "options"`, foo = "bar", options.diff = TRUE}

```
````

```{options, foo = "bar", options.diff = TRUE}

```
